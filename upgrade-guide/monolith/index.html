<!doctype html><html><head><title>Monolith :: Lucid</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2022-11-15T10:19:24 UTC"><meta name=description content><title>Monolith :: Lucid</title><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css integrity=sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css><script src=https://code.jquery.com/jquery-3.5.1.min.js></script>
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel=stylesheet><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/layout.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.main.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.menu.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/notice.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/tabs.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/panel.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/columns.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/children.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/attachments.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/alert.css><link rel=stylesheet type=text/css href=/css/docport.css><script src=/js/docport.js></script>
<script type=text/javascript>var baseurl="https://docs.lucidarch.dev"</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-96232175-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/syntax.css><link rel=apple-touch-icon sizes=180x180 href=/icon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icon/favicon-16x16.png><link rel=manifest href=/icon/site.webmanifest><script async defer src=https://buttons.github.io/buttons.js></script></head><body data-url=/upgrade-guide/monolith/ class="hideheader hidetoc"><style type=text/css>#debug{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:3.5rem;margin-bottom:.35rem;padding:0 2rem;position:fixed;left:0;right:0;top:0;top:0;min-height:150px;background-color:#fff;border:3px solid red;z-index:10000;word-wrap:all;overflow:auto}</style><article><aside><div class=search><div class=searchbox><input data-search-input id=search-by type=text placeholder="Type to search..."></div><script type=text/javascript src=/vendor/lunr/lunr.min.js></script>
<script type=text/javascript src=/vendor/auto-complete/auto-complete.js></script>
<link href=/vendor/auto-complete/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="https://docs.lucidarch.dev"</script><script type=text/javascript src=/js/search.js></script></div><div style=margin-top:30px><a href=/concept style=display:flex;justify-content:left;align-items:center><img src=/icon/logo.png width=250 style=margin-left:10px></a></div><div id=close_menu><a href=javascript:void(0); style=font-size:15px onclick='$("article > aside").toggleClass("responsive")'><i class="fa fa-lg fa-times"></i></a></div><ul class=menu><li data-nav-id=https://docs.lucidarch.dev/concept/ class="dd-item
item_level_$level"><a href=/concept/>Concept</a></li><li data-nav-id=https://docs.lucidarch.dev/philosophy/ class="dd-item
item_level_$level"><a href=/philosophy/>Philosophy</a></li><li data-nav-id=https://docs.lucidarch.dev/principles/ class="dd-item
item_level_$level"><a href=/principles/>Principles</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/installation/ class="dd-item
item_level_$level"><a href=/installation/>Installation</a></li><li data-nav-id=https://docs.lucidarch.dev/upgrade-guide/ class="dd-item parent active alwaysopen
item_level_$level"><a href=/upgrade-guide/>Upgrade Guide</a></li><li data-nav-id=https://docs.lucidarch.dev/contribution-guide/ class="dd-item
item_level_$level"><a href=/contribution-guide/>Contribution Guide</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/getting-started/ class="dd-item alwaysopen
item_level_$level"><a href=/getting-started/>Getting Started</a></li><li data-nav-id=https://docs.lucidarch.dev/micro-vs-monolith/ class="dd-item
item_level_$level"><a href=/micro-vs-monolith/>Micro • Monolith</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/routing/ class="dd-item
item_level_$level"><a href=/routing/>Routing</a></li><li data-nav-id=https://docs.lucidarch.dev/controllers/ class="dd-item
item_level_$level"><a href=/controllers/>Controllers</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/features/ class="dd-item
item_level_$level"><a href=/features/>Features</a></li><li data-nav-id=https://docs.lucidarch.dev/jobs/ class="dd-item
item_level_$level"><a href=/jobs/>Jobs</a></li><li data-nav-id=https://docs.lucidarch.dev/operations/ class="dd-item
item_level_$level"><a href=/operations/>Operations</a></li><li data-nav-id=https://docs.lucidarch.dev/services/ class="dd-item
item_level_$level"><a href=/services/>Services</a></li><li data-nav-id=https://docs.lucidarch.dev/domains/ class="dd-item
item_level_$level"><a href=/domains/>Domains</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/testing/ class="dd-item
item_level_$level"><a href=/testing/>Testing</a></li><li data-nav-id=https://docs.lucidarch.dev/database/ class="dd-item
item_level_$level"><a href=/database/>Database</a></li><li data-nav-id=https://docs.lucidarch.dev/validation/ class="dd-item
item_level_$level"><a href=/validation/>Validation</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/cli/ class="dd-item
item_level_$level"><a href=/cli/>CLI Reference</a></li></ul></aside><section class=page><nav id=ariane aria-label=breadcrumb><ol class=ariane><li><a class=text-link href=https://docs.lucidarch.dev>Home</a></li><li><a class=text-link href=/upgrade-guide/>Upgrade Guide</a></li><li class=active>Monolith</li></ol></nav><h1>Upgrade Guide<span>Monolith</span></h1><nav class=subpages><li><a title=$pagetitle href=/upgrade-guide/micro/>Micro</a></li><li class=active><a title=$pagetitle href=/upgrade-guide/monolith/>Monolith</a></li></nav><div class=content><p>Ensure that your tests are passing at the initial state of the upgrade to be able to compare with by the end that you&rsquo;ve received the expected result.</p><ul><li><p>remove deprecated Lucid packages</p><p><code>composer remove lucid-arch/laravel-foundation lucid-arch/laravel-console</code></p><p>It is expected to see failures in the post-script since there are classes that no longer exist</p></li><li><p>add <code>lucidarch/lucid</code></p><p><code>composer require lucidarch/lucid</code></p></li></ul><h2 ref=files>Files</h2><a class=anchor id=files></a><p>Moving everything from <code>/src</code> to <code>/app</code></p><ul><li><p>Data</p></li><li><p>Domains</p></li><li><p>Foundation</p></li><li><p>Services</p></li><li><p><code>Services/&lt;service>/Tests/Features</code> → <code>tests/Feature/Services/&lt;service></code></p></li><li><p><code>Services/&lt;service>/Tests/Operations</code> and other unit tests → <code>tests/Unit/Services/&lt;service>/Operations</code></p></li><li><p>Move domain tests <code>app/Domains/&lt;domain>/Tests</code> → <code>tests/Unit/Domains/&lt;domain></code></p><p>use the script below to do that for you, run it at the root of the project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>BASE_DIR</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>TESTS_DIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$BASE_DIR</span><span class=s2>/tests&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mkdir <span class=nv>$BASE_DIR</span>/tests/Unit/Domains
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> d in ./app/Domains/* <span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nv>DOMAIN</span><span class=o>=</span><span class=si>${</span><span class=nv>d</span><span class=p>##*/</span><span class=si>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;moving </span><span class=nv>$d</span><span class=s2>/Tests --&gt; </span><span class=nv>$TESTS_DIR</span><span class=s2>/Unit/Domains/</span><span class=nv>$DOMAIN</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    mv <span class=s2>&#34;</span><span class=nv>$d</span><span class=s2>/Tests&#34;</span> <span class=nv>$TESTS_DIR</span>/Unit/Domains/<span class=nv>$DOMAIN</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mkdir <span class=nv>$BASE_DIR</span>/tests/Unit/Services <span class=nv>$BASE_DIR</span>/tests/Feature/Services
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> s in ./app/Services/* <span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nv>SERVICE</span><span class=o>=</span><span class=si>${</span><span class=nv>s</span><span class=p>##*/</span><span class=si>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;moving </span><span class=nv>$s</span><span class=s2>/Tests/Features --&gt; </span><span class=nv>$TESTS_DIR</span><span class=s2>/Feature/Services/</span><span class=nv>$SERVICE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    mv <span class=s2>&#34;</span><span class=nv>$s</span><span class=s2>/Tests/Features&#34;</span> <span class=nv>$TESTS_DIR</span>/Feature/Services/<span class=nv>$SERVICE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;moving </span><span class=nv>$s</span><span class=s2>/Tests/Operations --&gt; </span><span class=nv>$TESTS_DIR</span><span class=s2>/Unit/Services/</span><span class=nv>$SERVICE</span><span class=s2>/Operations&#34;</span>
</span></span><span class=line><span class=cl>    mv <span class=s2>&#34;</span><span class=nv>$s</span><span class=s2>/Tests/Operations&#34;</span> <span class=nv>$TESTS_DIR</span>/Unit/Services/<span class=nv>$SERVICE</span>/Operations
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div></li></ul><h2 ref=namespaces>Namespaces</h2><a class=anchor id=namespaces></a><ul><li>Rename Framework namespaces in <code>/app</code><ul><li><code>namespace Framework\</code> → <code>namespace App\</code></li><li><code>use Framework\</code> → <code>use App\</code></li></ul></li><li>Rename Framework in <code>/bootstrap</code> , <code>/app</code> and <code>/config</code><ul><li><code>Framework\</code> → <code>App\</code></li></ul></li><li>Rename custom namespace in <code>/app</code><ul><li><code>namespace SocialSource\</code> → <code>namespace App\</code></li><li><code>use SocialSource\</code> → <code>use App\</code></li></ul></li><li><code>app/RouteServiceProvider.php</code> rename <code>Framework\</code> to <code>App\</code> in <code>protected $namespace</code></li></ul><p>Replace unit namespaces (find & replace in <code>app</code> folder. Additionally you may want to search other folders such as <code>tests</code>):</p><ul><li><p>Jobs</p><p><code>use Lucid\Foundation\Job;</code> → <code>use Lucid\Units\Job;</code></p></li><li><p>Operations</p><p><code>use Lucid\Foundation\Operation;</code> → <code>use Lucid\Units\Operation;</code></p></li><li><p>Features</p><p><code>use Lucid\Foundation\Feature;</code> → <code>use Lucid\Units\Feature;</code></p></li><li><p>Services</p><p><code>Lucid\Foundation\Providers</code> → <code>Lucid\Providers</code></p></li><li><p>Controllers</p><p><code>use Lucid\Foundation\Http\Controller;</code> → <code>use Lucid\Units\Controller;</code></p></li><li><p>Exceptions</p><p><code>Lucid\Foundation\InvalidInputException</code> → <code>Lucid\Exceptions\InvalidInputException</code></p></li><li><p>Validator</p><p><code>use Lucid\Foundation\Validator;</code> → <code>use Lucid\Validation\Validator;</code></p></li><li><p>Replace traits namespaces</p><ul><li><code>use Lucid\Foundation\ServesFeaturesTrait;</code> → <code>use Lucid\Bus\ServesFeatures;</code></li><li><code>use ServesFeaturesTrait;</code> → <code>use ServesFeatures;</code></li></ul></li><li><p>Update <code>phpunit.xml</code></p><ul><li>Remove <code>Services</code> and <code>Domains</code> testsuits</li></ul></li></ul><h2 ref=composer>Composer</h2><a class=anchor id=composer></a><ul><li>delete the line under <code>autoload.psr-4</code>: <code>"Framework\\": "app/",</code></li><li>reset namespace of <code>src</code> <code>"App\\": "app/",</code></li></ul><p>The following content (besides custom ones) must be present in <code>composer.json</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;autoload&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;psr-4&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;App\\&#34;</span><span class=p>:</span> <span class=s2>&#34;app/&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;autoload-dev&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;psr-4&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Tests\\&#34;</span><span class=p>:</span> <span class=s2>&#34;tests/&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><p>Run <code>composer dump-autoload</code> to feel the waters</p><p>This time it should all be clear of errors. Otherwise, keep digging and replacing until it passes</p></li><li><p>Run tests again and expect the same results as in the run before the upgrade</p></li></ul></div><div class=chevrons><a class=next href=/contribution-guide/ title="Contribution Guide" style=margin-right:0><div><p>Next page</p><label>Contribution Guide</label></div><i class="fas fa-arrow-right" style=font-size:1.7em></i></a></div></section></article><footer><div class=columns><div class=column><div style=font-family:Raleway!important><h3 style=color:#fdfdfd!important>lucid architecture</h3>for a scalable future software</div></div><div class=column><div style=display:flex;justify-content:flex-end;align-items:center><div style=align-items:center;display:flex><a href=https://lucidarch.dev target=_blank><img src=/icon/lucid-coloured.png alt="Lucid website link" width=28px style=margin-top:4px></a>
<a href=https://github.com/lucidarch target=_blank style=margin-left:10px><i class="fab fa-github fa-lg"></i></a>
<a href=https://lucid-slack.herokuapp.com target=_blank style=margin-left:10px><i class="fab fa-slack fa-lg"></i></a>
<a href=https://www.reddit.com/r/lucidarch target=_blank style=margin-left:10px><i class="fab fa-reddit-alien fa-lg"></i></a></div><div style=margin-left:50px;margin-top:6px><a class=github-button href=https://github.com/sponsors/lucidarch data-icon=octicon-heart aria-label="Sponsor @lucidarch on GitHub">Sponsor</a>
<a class=github-button href=https://github.com/lucidarch/lucid data-icon=octicon-star data-show-count=true aria-label="Star lucidarch/lucid on GitHub">Star</a></div></div></div></div></footer></body></html>